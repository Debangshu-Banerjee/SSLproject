{% extends 'base.html' %}
{% load staticfiles %}
{% load crispy_forms_tags %}
{% block content %}

<!-- Content Wrapper. Contains page content -->
  <div >
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        User Profile
      </h1>
      <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li><a href="#">Examples</a></li>
        <li class="active">User profile</li>
      </ol>
    </section>


<section class="content">

     <div class="row">
       <div class="col-md-3">

         <!-- Profile Image -->
         <div class="box box-primary">
           <div class="box-body box-profile">
             <img class="profile-user-img img-responsive img-circle" src="{{ prof.fbprofile_photo }}" alt="User profile picture">

             <h3 class="profile-username text-center">{{ prof.first_name }} {{ prof.second_name }}</h3>

             <p class="text-muted text-center">{{ prof.designation }}</p>

             <ul class="list-group list-group-unbordered">
               <li class="list-group-item">
                 <b>Mail</b> <a class="pull-right">{{ prof.webmail }}</a>
               </li>
               <li class="list-group-item">
                 <b>Phone No</b> <a class="pull-right">{{ prof.phone_number }}</a>
               </li>
               <li class="list-group-item">
                 <b>Department</b> <a class="pull-right"> {{ prof.department }}</a>
               </li>
               <li class="list-group-item">
                {% if request.user.username == prof.user.username %}
                <b>fb</b>  <a href="{% url 'social:begin' 'facebook' %}" class="pull-right">get current avatar </a>
                 {% endif %}
                   <!--{{ prof.fbprofile_photo }} -->
                </li>
             </ul>
             {% if request.user.username == prof.user.username %}
             <a href="{% url 'mywebsite:update' whoami=prof %}" class="btn btn-primary btn-block"><b>Edit</b></a>
             {% endif %}
           </div>
           <!-- /.box-body -->
         </div>
         <!-- /.box -->

         <!-- About Me Box -->
         <div class="box box-primary">
           <div class="box-header with-border">
             <h3 class="box-title">About Me</h3>
           </div>
           <!-- /.box-header -->
           <div class="box-body">
             <strong><i class="fa fa-book margin-r-5"></i> Education</strong>

             <p class="text-muted">
              {{ prof.education }}
             </p>

             <hr>

             <strong><i class="fa fa-map-marker margin-r-5"></i> Home Town</strong>

             <p class="text-muted">Guwahati,India</p>

             <hr>

             <strong><i class="fa fa-pencil margin-r-5"></i> Current Courses</strong>

             <p>
               {% for course in prof.courses_set.all %}
                  {% if course.current %}
                    <span class="label label-danger"> {{ course.courseName }}</span>
                  {% endif %}
                {% endfor %}
             </p>
             <br>
             <a href="{% url 'mywebsite:courses' person=prof %}" type="button" class="btn btn-default">
              See all courses
            </a>
             <hr>
             {% if prof.bio %}
             <strong><i class="fa fa-file-text-o margin-r-5"></i> Bio</strong>

             <p>{{ prof.bio }}</p>
             {% endif %}
           </div>
           <!-- /.box-body -->
         </div>
         <!-- /.box -->
       </div>
       <!-- /.col -->
       <div class="col-md-9">
         <div class="nav-tabs-custom">
           <ul class="nav nav-tabs">
             <li class="active"><a href="#activity" data-toggle="tab">Publications</a></li>
             <li><a href="#timeline" data-toggle="tab">Research Interests</a></li>
             <li><a href="#settings" data-toggle="tab">Students</a></li>
           </ul>
           <div class="tab-content">
             <div class="active tab-pane" id="activity">
               <ul>
                 {% for publication in prof.publica_set.all %}
                 <li> {{ publication.publication_title }} </li>
                 {% endfor %}
               </ul>
               {% if request.user.username == prof.user.username %}
               <button type="button" class="btn btn-default" data-toggle="modal" data-target="#modal-default">
                Add
              </button>
              {% endif %}
              <div class="modal fade" id="modal-default">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span></button>
                  <h4 class="modal-title">Add a publication</h4>
                </div>
                <div class="modal-body">
                  <form method="POST" >
                    {% csrf_token %}
                    <table border="5">
                      {{ form|crispy }}
                    </table>
                     <button type="submit" name="addPublication" class="save btn btn-primary">Save</button>
                 </form>
                </div>
              </div>
              <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
          </div>
            </div>
             <!-- /.tab-pane -->
             <div class="tab-pane" id="timeline">

             </div>
             <!-- /.tab-pane -->

             <div class="tab-pane" id="settings">
                 {% for student in prof.students_set.all %}
                   <div class="user-block">
                     <img class="img-circle img-bordered-sm" src="{{ student.pic.url }}" alt="user image">
                        <span class="username">
                          <a href="#">{{ student.name }}</a>
                        </span>
                    <span class="description">{{ student.details }}</span>
                  </div>
                  <br>
                 {% endfor %}
               {% if request.user.username == prof.user.username %}
               <button type="button" class="btn btn-info" data-toggle="modal" data-target="#modal-primary">
                 Add
               </button>
               {% endif %}
               <div class="modal modal-primary fade" id="modal-primary">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span></button>
                      <h4 class="modal-title">Add a student</h4>
                    </div>
                    <div class="modal-body">
                      <form method="POST" >
                        {% csrf_token %}
                        <table border="5">
                          {{ form1|crispy }}
                          </table>
                          <div class="modal-footer">
                          <button type="submit" name="addStudent" class="save btn btn-primary">Save</button>
                      </div>
                    </form>
                  </div>
                </div>
            <!-- /.modal-content -->
            </div>
          <!-- /.modal-dialog -->
          </div>
             </div>
             <!-- /.tab-pane -->
           </div>
           <!-- /.tab-content -->
         </div>
         <!-- /.nav-tabs-custom -->
       </div>
       <!-- /.col -->
     </div>
     <!-- /.row -->

{% endblock %}
